<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:include="base :: head">
</head>
<body>
	<header th:include="base :: header"> </header>
	<section class="container" th:fragment="alerts">
		<!--  Cuando no hay alertas -->
		<div
			th:if="${#lists.isEmpty(alertsUncheck) and #lists.isEmpty(alertsCheck)}"
			class="watermark">
			<h1>No hay alertas</h1>
		</div>
		<!--  Cuando hay alertas -->
		<div
			th:if="${!#lists.isEmpty(alertsUncheck) or !#lists.isEmpty(alertsCheck)}"
			class="row">
			<div class="col s12">
				<ul class="tabs transparent">
					<li class="tab col s3"><a class="active" href="#uncheck">Alertas
							sin resolver</a></li>
					<li class="tab col s3"><a href="#check">Alertas resueltas</a></li>
				</ul>
			</div>
			<!-- Pestaña alertas activas -->
			<div id="uncheck" class="row">
				<div th:if="${#lists.isEmpty(alertsUncheck)}" class="watermark">
					<h1>No hay alertas sin resolver</h1>
				</div>
				<div th:each="alert : ${alertsUncheck}" class="col s12 day">
					<div class="row">
						<div class="col s12 m12">
							<div class="card">
								<div class="card-image primary-color">
									<span th:inline="text" class="card-title secondary-color">[[${alert.alert.title}]]</span><span
										class="strong right"><a
										sec:authorize="isAuthenticated()"
										th:href="@{/alerts/get/{id}/check(id=${alert.id})}" href="#">Resolver</a></span>
								</div>
								<div class="card-content">
									<div th:each="day : ${alert.getAllNewsDetectOrderByDate()}"
										class="col s12 day">
										<span
											th:if="${#dates.format(hoy, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}">Hoy</span>
										<span
											th:if="${#dates.format(ayer, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}">Ayer</span>
										<span
											th:unless="${#dates.format(hoy, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy') or #dates.format(ayer, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}"
											th:text="${#dates.format(day.key, 'dd/MM/yyyy')}">Ayer</span>
										<ul class="collapsible popout" data-collapsible="accordion">
											<!-- Comienzo de la alerta -->
											<li th:each="news : ${day.value}">
												<div th:inline="text" class="collapsible-header">
													[[${news.title}]]<a sec:authorize="isAuthenticated()"
														th:href="@{/alerts/get/{id}/check(id=${alert.id})}"
														href="#"><a class="right" th:href="${news.link}"
														href="http://www.google.es"> <i
															class="mdi-content-link tooltipped"
															data-position="bottom" data-delay="50"
															th:attr="data-tooltip=${news.link}"
															data-tooltip="URL del enlace"></i>[[${news.site.name}]]
													</a></a>
												</div>
												<div class="collapsible-body">
													<blockquote>
														<h3>Palabras encontradas</h3>
														<ul>
															<li th:each="word : ${news.wordsDetect}"
																th:text="${word}">Jerez</li>
														</ul>
													</blockquote>
													<blockquote>
														<h3>Lugares afectados</h3>
														<ul>
															<li th:each="loc : ${news.getCountryWithLocations()}">
																<!-- Modal Trigger --> <a
																class="waves-effect waves-light btn modal-trigger"
																th:href="${'#'+ loc.key}" href="#modal1"
																th:text="${loc.key.name}">Modal</a> <!-- Modal Structure -->
																<div th:id="${loc.key}" id="modal1"
																	class="modal bottom-sheet">
																	<div class="modal-content">
																		<h4 th:inline="text">Proveedores de [[loc.key.name]]</h4>
																		<p th:each="p : ${loc.value}" th:text="${p}">A bunch of text</p>
																	</div>
																	<div class="modal-footer">
																		<a href="#!"
																			class=" modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
																	</div>
																</div>
															</li>
														</ul>
													</blockquote>
												</div>
											</li>
											<!-- Fin de la alerta -->
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- Pestaña alertas resueltas -->
			<div id="check" class="row">
				<div th:if="${#lists.isEmpty(alertsCheck)}" class="watermark">
					<h1>No hay alertas resueltas</h1>
				</div>
				<div th:each="alert : ${alertsCheck}" class="col s12 day">
					<div class="row">
						<div class="col s12 m12">
							<div class="card">
								<div class="card-image primary-color">
									<span th:inline="text" class="card-title secondary-color">[[${alert.alert.title}]]</span>
								</div>
								<div class="card-content">
									<div th:each="day : ${alert.getAllNewsDetectOrderByDate()}"
										class="col s12 day">
										<span
											th:if="${#dates.format(hoy, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}">Hoy</span>
										<span
											th:if="${#dates.format(ayer, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}">Ayer</span>
										<span
											th:unless="${#dates.format(hoy, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy') or #dates.format(ayer, 'dd/MM/yyyy')==#dates.format(day.key, 'dd/MM/yyyy')}"
											th:text="${#dates.format(day.key, 'dd/MM/yyyy')}">Ayer</span>
										<ul class="collapsible popout" data-collapsible="accordion">
											<!-- Comienzo de la alerta -->
											<li th:each="news : ${day.value}">
												<div th:inline="text" class="collapsible-header">
													[[${news.title}]]<a sec:authorize="isAuthenticated()"
														th:href="@{/alerts/get/{id}/check(id=${alert.id})}"
														href="#"><a class="right" th:href="${news.link}"
														href="http://www.google.es"> <i
															class="mdi-content-link tooltipped"
															data-position="bottom" data-delay="50"
															th:attr="data-tooltip=${news.link}"
															data-tooltip="URL del enlace"></i>[[${news.site.name}]]
													</a></a>
												</div>
												<div class="collapsible-body">
													<blockquote>
														<h3>Palabras encontradas</h3>
														<ul>
															<li th:each="word : ${news.wordsDetect}"
																th:text="${word}">Jerez</li>
														</ul>
													</blockquote>
													<blockquote>
														<h3>Lugares afectados</h3>
														<ul>
															<li th:each="loc : ${news.getCountryWithLocations()}">
																<!-- Modal Trigger --> <a
																class="waves-effect waves-light btn modal-trigger"
																th:href="${'#'+ loc.key}" href="#modal1"
																th:text="${loc.key.name}">Modal</a> <!-- Modal Structure -->
																<div th:id="${loc.key}" id="modal1"
																	class="modal bottom-sheet">
																	<div class="modal-content">
																		<h4 th:inline="text">Proveedores de [[${loc.key.name}]]</h4>
																		<p th:each="p : ${loc.value}" th:text="${p}">A bunch of text</p>
																	</div>
																	<div class="modal-footer">
																		<a href="#!"
																			class=" modal-action modal-close waves-effect waves-green btn-flat">Agree</a>
																	</div>
																</div>
															</li>
														</ul>
													</blockquote>
												</div>
											</li>
											<!-- Fin de la alerta -->
										</ul>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<footer th:include="base :: footer"> </footer>
		<script type="text/javascript">
		$(document).ready(function() {
			// the "href" attribute of .modal-trigger must specify the modal ID that wants to be triggered
			$('.modal-trigger').leanModal();
		});
	</script>
</body>
</html>
