<!DOCTYPE html>
<html lang="es" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head th:include="base :: head">
</head>
<body>
	<div
		class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
		<header
			class="demo-header mdl-layout__header mdl-color--white mdl-color--grey-100 mdl-color-text--grey-600"
			th:replace="base :: menu-superior"> </header>
		<div
			class="demo-drawer mdl-layout__drawer mdl-color--primary mdl-color-text--blue-grey-50"
			th:include="base :: menu-izquierdo"></div>
		<main
			class="mdl-layout__content mdl-color--grey-100 mdl-typography--text-center">
		<div class="doc-page mdl-grid">
			<div class="mdl-cell mdl-cell--1-col"></div>
			<div
				class="mdl-cell mdl-cell--10-col mdl-color--white mdl-shadow--2dp">
				<div th:inline="text"
					class="mdl-cell mdl-cell--12-col mdl-cell--12-col-desktop mdl-typography--display-1-color-contrast">
					[[${feed.name==null ? 'AÃ±adir sitio' : 'Editar sitio'}]]</div>
				<form action="#" val:validate="${feed}" th:object="${feed}"
					method="post">
					<input type="hidden" th:name="${_csrf.parameterName}"
						th:value="${_csrf.token}" />
					<div class="mdl-cell mdl-cell--3-col">
						<label class="mdl-switch mdl-js-switch mdl-js-ripple-effect"
							for="rss"> <input type="checkbox"
							class="mdl-switch__input" id="rss" name="isRSS"
							th:checked="*{isRSS}" /> <span class="mdl-switch__label">&iquest;Es
								un sitio con RSS?</span>
						</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input class="mdl-textfield__input" type="text" th:field="*{name}" />
						<label class="mdl-textfield__label" for="name">Nombre del
							sitio</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<select class="mdl-textfield__input" th:field="*{type}">
							<option value="" disabled="disabled" selected="selected">Fiabilidad
								del Sitio</option>
							<option th:each="type : ${enumFiabilidad}" th:value="${type}"
								th:text="${type}">Wireframe</option>
						</select> <label class="mdl-textfield__label">Fiabilidad del Sitio</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<select class="mdl-textfield__input" th:field="*{languaje}">
							<option value="" disabled="disabled" selected="selected">Idioma
								del sitio</option>
							<option th:each="type : ${enumLanguaje}" th:value="${type}"
								th:text="${type}">Wireframe</option>
						</select> <label class="mdl-textfield__label">Idioma del Sitio</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input class="mdl-textfield__input" type="text" th:field="*{url}" />
						<label class="mdl-textfield__label" for="url">Url del
							sitio</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input class="mdl-textfield__input" type="text"
							th:field="*{dateFormat}" /> <label class="mdl-textfield__label"
							for="dateFormat">Formato de la fecha(si hay que parsear
							de texto)</label>
					</div>
					<div
						class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input class="mdl-textfield__input" type="text"
							th:field="*{urlNews}" /> <label class="mdl-textfield__label"
							id="labelUrl" for="urlRSS"
							th:text="*{isRSS}?'Url del RSS de noticias':'Url de la primera p&aacute;gina de noticias'">
						</label>
					</div>
					<div class="html">
						<div
							class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
							<input class="mdl-textfield__input" type="text"
								th:field="*{newsLink}" /> <label class="mdl-textfield__label"
								for="newsLink">Clase CSS para seleccionar las noticias</label>
						</div>
					</div>
					<div class="html row">
						<div class="input-field col s12">
							<table>
								<thead>
									<tr>
										<th>Url a las p&aacute;ginas adicionales de noticias</th>
										<th>
											<button class="btn" type="submit" name="addPage">A&ntilde;adir
												p&aacute;gina</button>
										</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="row,rowStat : *{urlPages}">
										<td><input type="text"
											th:field="*{urlPages[__${rowStat.index}__]}" /></td>
										<td>
											<button th:value="${rowStat.index}" class="btn" type="submit"
												name="removePage">Remove row</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<table>
								<thead>
									<tr>
										<th>Selectores de partes HTML</th>
										<th>
											<button class="btn" type="submit" name="addHtml">A&ntilde;adir
												selector</button>
										</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="row,rowStat : *{selectorHtml}">
										<td><input type="text"
											th:field="*{selectorHtml[__${rowStat.index}__].key}" /></td>
										<td><input type="text"
											th:field="*{selectorHtml[__${rowStat.index}__].value}" /></td>
										<td>
											<button th:value="${rowStat.index}" class="btn" type="submit"
												name="removeHtml">Remove row</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="row">
						<div class="input-field col s12">
							<table>
								<thead>
									<tr>
										<th>Selectores de metadatos</th>
										<th>
											<button class="btn" type="submit" name="addMeta">A&ntilde;adir
												selector</button>
										</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="row,rowStat : *{selectorMeta}">
										<td><input type="text"
											th:field="*{selectorMeta[__${rowStat.index}__].key}" /></td>
										<td><input type="text"
											th:field="*{selectorMeta[__${rowStat.index}__].value}" /></td>
										<td>
											<button class="btn" th:value="${rowStat.index}" type="submit"
												name="removeMeta">Remove row</button>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="mdl-grid">
						<div class="mdl-cell mdl-cell--1-col"></div>
						<div class="mdl-cell mdl-cell--10-col">
							<button class="mdl-button mdl-js-button mdl-color--primary"
								type="submit">Enviar</button>
							<button id="test" class="mdl-button mdl-js-button" type="submit"
								name="testFeed">Probar sitio</button>
						</div>
					</div>
				</form>
			</div>
		</div>
		</main>
		<footer th:include="base :: footer"> </footer>
		<script th:inline="javascript">
			/*<![CDATA[*/
			$(document)
					.ready(
							function() {
								if (!$("#rss").is(":checked")) {
									$(".rss").hide();
									$(".html").show();
								} else {
									$(".rss").show();
									$(".html").hide();
								}
								$('#rss')
										.change(
												function() {
													if (!$("#rss").is(
															":checked")) {
														$(".rss").hide();
														$(".html").show();
														$("#labelUrl")
																.html(
																		"Url de la primera p&aacute;gina de noticias");
													} else {
														$(".rss").show();
														$(".html").hide();
														$("#labelUrl")
																.html(
																		"Url del RSS de noticias");
													}
												});
								$(".right").submit(function() {
									return false;
								});
								$("#test")
										.click(
												function(event) {
													$form = $(this).parents(
															"form");
													$
															.post(
																	$form
																			.attr("action"),
																	$form
																			.serialize()
																			+ "&testFeed=",
																	function(
																			data) {
																		var response = jQuery
																				.parseJSON(JSON
																						.stringify(data));
																		var date = new Date(
																				response.pubDate);
																		$(
																				"#modal")
																				.html(
																						'<div id="modal1" class="modal">'
																								+ '<div class="modal-content">'
																								+ '<h4>Noticia obtenida del sitio</h4>'
																								+ '<p>Titulo de la noticia:'
																								+ response.title
																								+ '</p>'
																								+ '<p>Contenido de la noticia:'
																								+ response.content
																								+ '</p>'
																								+ '<p>Url de la noticia:'
																								+ response.url
																								+ '</p>'
																								+ '<p>Fecha de publicacion de la noticia:'
																								+ date
																								+ '</p>'
																								+ '</div>'
																								+ '<div class="modal-footer">'
																								+ '<a href="#!" class=" modal-action modal-close waves-effect waves-green btn-flat">Cerrar</a>'
																								+ '</div>'
																								+ '</div>');
																		$(
																				'#modal1')
																				.openModal();
																	});
													return false;
												});
							});
			/*]]>*/
		</script>
	</div>
</body>
</html>
